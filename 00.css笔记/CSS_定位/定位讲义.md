# 定位(position)

## 目标

* **记忆**
  * 能够说出 CSS 的布局的三种机制  
* **理解**
  * 能说出为什么要用定位
  * 能说出定位的4种分类
  * 能说出四种定位的各自特点
  * 能说出我们为什么常用子绝父相布局
* **应用**
  * 能写出小米轮播图

## 1. CSS 布局的三种机制

> 网页布局的核心 —— 就是**用 CSS 来摆放盒子位置**。

CSS 提供了 **3 种机制**来设置盒子的摆放位置，分别是**普通流**、**浮动**和**定位**，其中：

1. **普通流**（**标准流**）
   * 一个网页内的标签元素按照**从上到下，从左到右**的顺序排列：
     * **块级元素**会独占一行，**从上向下**顺序排列。
     * **行内元素**会按照顺序，**从左到右**顺序排列。

2. **浮动**
   * 让盒子从普通流中**浮**起来 —— **让多个盒子(div)水平排列成一行**。

3. **定位**
   * 将盒子**定**在某一个**位**置  漂浮在其他盒子的上面  —— CSS 离不开定位，特别是后面的 js 特效。 

   * 特殊位置 压住

     ​

## 2. 认识定位(position)

**概念**：`定位 = 定位模式 + 边偏移`，将盒子**定**在某一个**位**置。

### 2.1 定位的作用

> 我们先来看几个**使用定位实现的页面效果**，同时思考一下**用标准流或浮动能否实现类似的效果**？

1. **小黄色块**在图片上移动，**吸引用户的眼球**。

   ![定位示例1](./images/01_定位示例1.gif)

2. **左右箭头**压在图片上，**方便用户交互**。

   ![定位示例2](./images/02_定位示例2.gif)

3. **hot**、**new** 压在盒子上方，**吸引用户的眼球**。

   ![定位示例3](./images/03_定位示例3.png)

> **结论**：要实现以上效果，**标准流**或**浮动**不太好做，这时候就需要使用到 CSS 布局的第 3 个机制 —— **定位**！

### 2.2 语法

> **定位的概念**：`定位 = 定位模式 + 边偏移`

#### 2.2.1 边偏移

在 CSS 中，通过 `top`、`bottom`、`left` 和 `right` 属性定义元素的**边偏移**：（方位名词）

| 边偏移属性    | 示例             | 描述                               |
| -------- | :------------- | -------------------------------- |
| `top`    | `top: 80px`    | **顶端**偏移量，定义元素相对于其父元素**上边线的距离**。 |
| `bottom` | `bottom: 80px` | **底部**偏移量，定义元素相对于其父元素**下边线的距离**。 |
| `left`   | `left: 80px`   | **左侧**偏移量，定义元素相对于其父元素**左边线的距离**。 |
| `right`  | `right: 80px`  | **右侧**偏移量，定义元素相对于其父元素**右边线的距离**。 |

**注意**：

1. **边偏移**需要和**定位模式**联合使用，**单独使用无效**；
2. `top` 和 `bottom` 不要同时使用；
3. `left` 和 `right` 不要同时使用。

> 案例演示：边偏移属性。

#### 2.2.2 定位模式（定位的分类）

在 CSS 中，通过 `position` 属性定义元素的**定位模式**，语法如下：

```css
选择器 { position: 属性值; }
```

| 值          |    语义    |   关键词   | 描述                      |
| ---------- | :------: | :-----: | ----------------------- |
| `static`   | **静态**定位 | **不定位** | 所有元素的默认定位方式。            |
| `relative` | **相对**定位 | **自恋**  | 相对于其**原标准流的位置**进行定位     |
| `absolute` | **绝对**定位 | **拼爹**  | 相对于其上一个**已经定位的父元素**进行定位 |
| `fixed`    | **固定**定位 | **浏览器** | 相对于**浏览器窗口**进行定位        |

### 2.3 定位模式间的区别

#### 2.3.1 静态定位(static)

**静态定位**是元素的默认定位方式，也就是说网页中**所有元素**默认**都是静态定位的** —— 按照标准流特性摆放位置。

> 用大白话来讲，**在不需要定位元素时，元素的定位属性就是 `static` 的**。

**注意**：在**静态模式**下，无法通过**边偏移属性**（`top`、`bottom`、`left` 或 `right`）来改变元素的位置。

**提示**：因为是默认值，所以**静态定位在布局时不使用**，但是要知道。

> 案例演示：静态模式下边偏移属性无效。

#### 2.3.2 相对定位(relative)

**相对定位**是元素**相对**于它 `在标准流中的位置 + 边偏移属性` 来设置元素的位置。（自恋型）

> 案例演示：相对定位案例。

**效果图**：

![相对定位案例](./images/04_相对定位案例.png)

**相对定位小结** —— **相对定位不脱标**

1. 以 `自己在标准流位置的左上角为基点 + 边偏移属性` 定位元素新的位置；

2. 原来**在标准流的区域继续占有**，后面的盒子仍然以标准流的方式对待它。

##### 与浮动的对比

* **浮动** —— 让多个块级元素在一行显示，**脱离标准流**；
* **相对定位** —— 让盒子移动到我们想要的位置，**不脱标**。

#### 2.3.3 绝对定位(absolute)  

**绝对定位**有两个重要的概念：（拼爹型）

1. **完全脱标** —— 完全不占位置；  
2. **父元素要有定位** —— `父元素在标准流中的位置 + 边偏移属性` 来设置元素的位置；
   * 如果当前父元素没有定位（**相对**、**绝对**或**固定**），则寻找上一级**有定位**的父元素；
   * 如果**所有父元素**都没有定位，则以**浏览器**为准定位（Document 文档）。
   * 如果父亲有定位，则以父亲为准。

> 案例演练：父级没有定位。

<img src="./images/05_绝对定位_父级无定位.png" width="700" />

> 案例演练：父级有定位。

<img src="./images/06_绝对定位_父级有定位.png" width="700" />

##### 定位口诀 —— 子绝父相

**子绝父相** —— **子级**是**绝对**定位，**父级**要用**相对**定位。

> **子绝父相**是使用绝对定位的口诀，要牢牢记住！

**疑问**：为什么在布局时，**子级元素**使用**绝对定位**时，**父级元素**就要用**相对定位**呢？

观察下图，思考一下在布局时，**左右两个方向的箭头图片**以及**父级盒子**的定位方式。

![子绝父相截图](./images/07_子绝父相截图.png)

**分析**：

1. **方向箭头**叠加在其他图片上方，应该使用**绝对定位**，因为**绝对定位完全脱标**，完全不占位置。
2. **父级盒子**应该使用**相对定位**，因为**相对定位不脱标**，后续盒子仍然以标准流的方式对待它。
   * 如果父级盒子也使用**绝对定位**，会完全脱标，那么下方的**广告盒子**会上移，这显然不是我们想要的。

**结论**：**父级要占有位置，子级要任意摆放**，这就是**子绝父相**的由来。

#### 2.3.4 固定定位(fixed)

**固定定位**是**绝对定位**的一种特殊形式： （认死理型）

1. **完全脱标** —— 完全不占位置；
2. 只认**浏览器的可视窗口** —— `浏览器可视窗口 + 边偏移属性` 来设置元素的位置；
   * 跟父元素没有任何关系；
   * 不随滚动条滚动。

> 案例演练：固定定位案例。

![固定定位案例](./images/08_固定定位案例.png)

**提示**：IE 6 等低版本浏览器不支持固定定位。

## 3. 定位(position)的案例

### 3.1 哈根达斯

**备课代码**：[哈根达斯备课代码](备课代码/07_哈根达斯.html)

**案例截图**：

<img src="./images/09_哈根达斯案例示意图.png" width="500"/>

#### 哈根达斯分析

1. 一个大的 `div` 中包含 `3` 张图片；
2. 大的 `div` 水平居中；
3. `2` 张小图片**重叠**在**广告**图片上方 —— 脱标，不占位置，需要使用**绝对定位**；
4. `2` 张小图片分别显示在**左上角**和**右下角** —— 需要**使用边偏移确定准确位置**。

**案例小结**：

1. **子绝父相** —— **子元素**使用**绝对定位**，**父元素**使用**相对定位**；
2. **与浮动的对比**：
   * **绝对定位**：脱标，**利用边偏移指定准确位置**；
   * **浮动**：脱标，不能指定准确位置，**让多个块级元素在一行显示**。

> 课堂练习：模拟老师的随堂案例完成**哈根达斯**案例（5 分钟）。

### 3.2 仿新浪头部和广告

**备课代码**：[仿新浪头部和广告](备课代码/08_仿新浪头部和广告.html)

#### 新浪案例分析

1. 顶部图片**固定**在浏览器可视窗口顶部，不会随窗口一起滚动；
2. 左右两侧的广告图片**固定**在浏览器可视窗口的左右两侧，不会随窗口一起滚动；
3. 注意：**底部的内容图片**初始**显示在顶部图片的下方**，如何解决？

#### 步骤 1 —— 顶部图片和底部内容

```css
.top {
    /* 注意：使用固定定位时，如果盒子中没有内容，需要指定宽度 */
    width: 100%;
    height: 44px;
    background: url(images/top.png) no-repeat top center;
    position: fixed;
    left: 0px;
    top: 0px;
}

.box {
    width: 1002px;
    /* 顶部的 44px 的 margin 可以让 box 显示在顶部图片下方 */
    margin: 44px auto;
}
```

**注意**：

1. 在使用固定定位时，如果盒子中没有内容，需要指定宽度（稍后就讲）；
2. 设置底部内容图片的**顶部 `margin`**，可以让底部盒子初始显示在顶部图片的下方。

#### 步骤 2 —— 左右两侧广告

```css
.ad-left,
.ad-right {
    position: fixed;
    top: 100px;
}

.ad-left {
    left: 0px;
}

.ad-right {
    right: 0px;
}
```

**注意**：不要同时使用 `left` 和 `right` 和边偏移属性。

**案例小结**：

1. **固定定位**的应用场景：**固定在浏览器可视窗口某个位置的布局**；
2. 在使用固定和绝对定位时，如果盒子中没有内容，需要指定宽度（稍后就讲）。

> 课堂练习：模拟老师的随堂案例完成**仿新浪头部和广告**案例（5 分钟）。

## 4. 定位(position)的扩展

### 4.1 绝对定位的盒子居中

> **注意**：**绝对定位**不能通过设置 `margin: auto` 设置**水平居中**。

在使用**绝对定位**时要想实现水平居中，可以按照下图的方法：

![绝对定位水平居中](images/10_绝对定位水平居中.png)

1. `left: 50%;`：让**盒子的左侧**移动到**父级元素的水平中心位置**；
2. `margin-left: -100px;`：让盒子**向左**移动**自身宽度的一半**。

> 案例演示：相对定位案例。

#### 盒子居中定位示意图

![绝对定位居中示意图](images/11_绝对定位居中示意图.png)

> 课堂练习：实现**盒子左中、右中、中上、中下、中中定位**（5 分钟）。

### 4.2 堆叠顺序（z-index）

在使用**定位**布局时，可能会**出现盒子重叠的情况**。应用 `z-index` 层叠等级属性可以**调整盒子的堆叠顺序**。如下图所示：

![zindex示意图](images/12_zindex示意图.png)

`z-index` 的特性如下：

1. **属性值**：**正整数**、**负整数**或 **0**，默认值是 0，数值越大，盒子越靠上；
2. 如果**属性值相同**，则按照书写顺序，**后来居上**；
3. **数字后面不能加单位**。

**注意**：`z-index` 只能应用于**相对定位**、**绝对定位**和**固定定位**的元素，其他**标准流**、**浮动**和**静态定位**无效。

> 案例演示：堆叠顺序。

### 4.3 行内块元素特性

 前面我们讲过， 行内块的特性，   一行可以有多个， 可以设置高度和宽度， 大小是受内容的影响。 

* 可以用inline-block  转换为行内块
* 可以用浮动 float 默认转换为行内块（类似，并不完全一样，因为浮动是脱标的）
* 绝对定位和固定定位也和浮动类似， 默认转换的特性 转换为行内块。

所以说， 一个行内的盒子，如果加了浮动、固定定位和绝对定位，不用转换，就可以给这个盒子直接设置宽度和高度等。

## 4. 综合演练 - 淘宝轮播图

## 5. 定位小结

| 定位模式         | 是否脱标占有位置   | 是否可以使用边偏移 | 移动位置基准           |
| ------------ | ---------- | --------- | ---------------- |
| 静态static     | 不脱标，正常模式   | 不可以       | 正常模式             |
| 相对定位relative | 不脱标，占有位置   | 可以        | 相对自身位置移动（自恋型）    |
| 绝对定位absolute | 完全脱标，不占有位置 | 可以        | 相对于定位父级移动位置（拼爹型） |
| 固定定位fixed    | 完全脱标，不占有位置 | 可以        | 相对于浏览器移动位置（认死理型） |